# 🧪 מדריך בדיקה - תיקון גודל תמונות

## 🎯 מה תיקנו?

תמונות היו מגיעות בגודל ענק ביחס לדפי Word/Excel.  
**עכשיו**: כל הדפים באותו גודל A4!

---

## ✅ איך לבדוק?

### שלב 1: הכן קבצים לבדיקה

צור תיקייה `C:\Temp\Input` עם:
- ✅ קובץ Word (למשל: `document.docx`)
- ✅ תמונה גדולה (למשל: `large_image.jpg`)
- ✅ קובץ Excel (למשל: `spreadsheet.xlsx`)

---

### שלב 2: הרץ את הסקריפט

```powershell
# 1. פתח PowerShell
# 2. נווט לתיקיית הפרויקט
cd "C:\Users\nechamao\Documents\POCPdf\Poc_PdfTron"

# 3. הרץ את הסקריפט
.\Tests\quick-merge-test.ps1
```

---

### שלב 3: בחר קבצים

```
📂 קבצים זמינים בתיקיית הקלט:
   1. document.docx
   2. large_image.jpg
   3. spreadsheet.xlsx

📝 הזן את שמות הקבצים לאיחוד (מופרדים בפסיק):
➤ קבצים: 1,2,3
```

---

### שלב 4: בדוק את התוצאה

ה-PDF המאוחד ייפתח אוטומטית. **בדוק**:

#### ✅ מה צריך לראות:
1. **כל הדפים באותו גודל** (A4 רגיל)
2. **התמונה מוקטנת פרופורציונלית** (לא ענקית!)
3. **יחס גובה-רוחב נשמר** (התמונה לא מעוותת)
4. **כל התוכן נראה** (לא חתוכים חלקים)

#### ❌ מה **לא** צריך לראות:
1. ❌ דף תמונה ענק שממלא כמה מסכים
2. ❌ דפים בגדלים שונים
3. ❌ תמונה מעוותת או חתוכה

---

## 🔍 בדיקה מפורטת

### בדוק בלוגים:

אם הסקריפט רץ בטרמינל, תראה:

```log
[Info] Normalizing page 2 from 3000x4000 to A4
[Debug] Scaling page 2 by factor 0.198
[Debug] Added 3 pages from large_image.jpg
```

**פירוש**:
- `Normalizing` = הנורמליזציה עובדת ✓
- `from 3000x4000` = התמונה הייתה ענקית
- `Scaling by factor 0.198` = התמונה הוקטנה ל-~20% מהגודל המקורי
- `Added 3 pages` = הדפים נוספו בהצלחה

---

### בדוק בPDF Reader:

1. **פתח את ה-PDF**
2. **לחץ על View → Page Display → Two Page View**
3. **השווה את גודל הדפים**

#### צפוי:
```
┌─────────┐ ┌─────────┐ ┌─────────┐
│ Word    │ │ Image   │ │ Excel   │
│ (A4)    │ │ (A4)    │ │ (A4)    │
│         │ │ smaller │ │         │
│         │ │ content │ │         │
└─────────┘ └─────────┘ └─────────┘
   595x842     595x842     595x842
```

#### לא צפוי:
```
┌─────────┐ ┌───────────────────┐ ┌─────────┐
│ Word    │ │   Image (HUGE!)   │ │ Excel   │
│ (A4)    │ │                   │ │ (A4)    │
│         │ │                   │ │         │
└─────────┘ └───────────────────┘ └─────────┘
   595x842        3000x4000         595x842
```

---

## 📊 תרחישי בדיקה

### בדיקה 1: תמונה רגילה (1024x768)
```powershell
➤ קבצים: document.docx,normal_image.jpg
```
**צפוי**: התמונה תישאר באותו גודל (לא גדולה מדי)

---

### בדיקה 2: תמונה ענקית (4000x3000)
```powershell
➤ קבצים: document.docx,huge_image.jpg
```
**צפוי**: התמונה תוקטן ל-A4
**לוג צפוי**: `Normalizing page 2 from 4000x3000 to A4`

---

### בדיקה 3: רק תמונות
```powershell
➤ קבצים: image1.jpg,image2.png,image3.jpg
```
**צפוי**: כל התמונות באותו גודל A4

---

### בדיקה 4: מעורב
```powershell
➤ קבצים: doc.docx,img.jpg,sheet.xlsx,slide.pptx
```
**צפוי**: כל 4 הדפים באותו גודל A4

---

## 🐛 אם משהו לא עובד

### בעיה: התמונה עדיין ענקית

**פתרון**:
1. ודא שהשרת עובד עם הקוד החדש
2. עצור את השרת (`Ctrl+C`)
3. הרץ מחדש: `dotnet run`
4. נסה שוב את הסקריפט

---

### בעיה: לא רואה לוגים

**פתרון**:
```powershell
# הרץ את השרת בטרמינל נפרד:
cd Poc_PdfTron
dotnet run

# ואז בטרמינל אחר הרץ את הסקריפט
.\Tests\testMerge.ps1
```

---

### בעיה: שגיאה בקומפילציה

**פתרון**:
```powershell
# נקה ובנה מחדש:
dotnet clean
dotnet build
```

---

## 📸 דוגמאות ויזואליות

### לפני התיקון:
```
📄 Word document    [■■■■    ] גודל רגיל
🖼️  Image           [■■■■■■■■] ענקית!
📊 Excel sheet      [■■■■    ] גודל רגיל
```

### אחרי התיקון:
```
📄 Word document    [■■■■] גודל A4
🖼️  Image           [■■■■] גודל A4 (תוכן מוקטן)
📊 Excel sheet      [■■■■] גודל A4
```

---

## ✅ רשימת בדיקה מהירה

- [ ] הרצתי את `quick-merge-test.ps1`
- [ ] בחרתי קובץ Word + תמונה גדולה + קובץ Excel
- [ ] ה-PDF נוצר בהצלחה
- [ ] כל הדפים באותו גודל
- [ ] התמונה נראית מוקטנת (לא ענקית)
- [ ] יחס התמונה נשמר (לא מעוות)
- [ ] כל התוכן נראה (לא חתוך)

**אם כל הסימונים V - התיקון עובד!** ✅

---

## 🎓 טיפים

### טיפ 1: בדיקה ויזואלית מהירה
פתח את ה-PDF ולחץ `Ctrl+L` (fit to width) - אם כל הדפים תופסים את אותו רוחב = עובד!

### טיפ 2: בדוק את המטאדטה
```powershell
# בPowerShell:
Add-Type -AssemblyName PresentationFramework
[System.Windows.MessageBox]::Show("Page size: A4 (595x842)")
```

### טיפ 3: השוואה
אחד את אותם קבצים לפני ואחרי - תראה את ההבדל!

---

## 📞 עזרה נוספת

- **תיאור מפורט**: `FIX_IMAGE_SIZE.md`
- **מדריך שימוש**: `HOW_TO_RUN.md`
- **סיכום מלא**: `QUICK_START.md`

---

**הצלחה בבדיקה!** 🚀
