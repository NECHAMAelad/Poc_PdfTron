# 📄 איחוד קבצים ל-PDF - מדריך מהיר

## מה זה עושה?
התכונה החדשה מאפשרת לך לקחת מספר קבצים (Word, Excel, תמונות וכו') ולאחד אותם לקובץ PDF אחד.

---

## איך להשתמש?

### דרך 1: סקריפט אוטומטי (הכי פשוט!)

```powershell
# הרץ את הסקריפט
.\Tests\testMerge.ps1
```

הסקריפט ישאל אותך:
1. אילו קבצים לאחד (מופרדים בפסיק)
2. איזה שם לתת לקובץ (אופציונלי)
3. אם לפתוח את הקובץ בסיום

**דוגמה:**
```
Files: document1.docx,image.jpg,report.xlsx
Output name: דוח_רבעוני
```

### דרך 2: ישירות עם PowerShell

```powershell
# הכנת הבקשה
$body = @{
    sourceFiles = "קובץ1.docx,תמונה.jpg,דוח.xlsx"
    outputFileName = "איחוד"
} | ConvertTo-Json

# שליחת הבקשה
$result = Invoke-RestMethod `
    -Uri "http://localhost:5000/api/pdfconversion/merge" `
    -Method Post `
    -Body $body `
    -ContentType "application/json"

# פתיחת הקובץ
Start-Process $result.outputFilePath
```

---

## איך זה עובד?

1. **המרה** - כל קובץ מומר ל-PDF בנפרד
2. **איחוד** - כל ה-PDFs מאוחדים לקובץ אחד
3. **שמירה** - הקובץ המאוחד נשמר בתיקיית הפלט

### הסדר חשוב!
הקבצים מאוחדים לפי הסדר שכתבת. למשל:
```
"עמוד_שער.docx,תמונה.jpg,סיכום.xlsx"
```
יהפוך ל-PDF עם:
1. עמוד שער
2. תמונה
3. סיכום

---

## דוגמאות מעשיות

### דוגמה 1: דוח רבעוני
```powershell
$body = @{
    sourceFiles = "כריכה.docx,גרפים.xlsx,תמונות.jpg,סיכום.txt"
    outputFileName = "דוח_רבעון_ראשון"
} | ConvertTo-Json
```

### דוגמה 2: מצגת מורחבת
```powershell
$body = @{
    sourceFiles = "מצגת.pptx,נספחים.xlsx,מכתב_המלצה.pdf"
    outputFileName = "מצגת_מלאה"
} | ConvertTo-Json
```

### דוגמה 3: תיק מסמכים
```powershell
$body = @{
    sourceFiles = "תעודת_זהות.jpg,קורות_חיים.docx,תעודות.pdf,המכתב.txt"
    outputFileName = "תיק_מועמדות"
} | ConvertTo-Json
```

---

## שגיאות נפוצות ופתרונות

### ❌ "File not found"
**בעיה:** הקובץ לא נמצא בתיקיית הקלט

**פתרון:**
1. ודא שהקובץ נמצא ב-`C:\Temp\Input`
2. ודא שהשם נכתב נכון (כולל סיומת)
3. השתמש בסקריפט - הוא מציג את כל הקבצים הזמינים

### ❌ "File extension not allowed"
**בעיה:** סוג הקובץ לא נתמך

**פתרון:** ודא שהקובץ הוא מאחד הסוגים הנתמכים:
- Word: `.docx`, `.doc`
- Excel: `.xlsx`, `.xls`
- PowerPoint: `.pptx`, `.ppt`
- תמונות: `.jpg`, `.png`, `.gif`, `.bmp`
- טקסט: `.txt`, `.rtf`
- ועוד...

### ⚠️ חלק מהקבצים נכשלו
זה בסדר! המערכת ממשיכה עם השאר:
```json
{
  "filesProcessed": 2,
  "totalFiles": 3,
  "successfulFiles": ["קובץ1.docx", "קובץ3.jpg"],
  "failedFiles": [
    {
      "fileName": "קובץ2.xlsx",
      "errorMessage": "File is locked"
    }
  ]
}
```

**פתרון:** סגור את הקבצים הכושלים ונסה שוב.

---

## טיפים ותכונות שימושיות

### 💡 טיפ 1: בדיקה לפני איחוד
אפשר לבדוק שכל הקבצים בסדר:
```powershell
# בדוק קובץ אחד
Invoke-RestMethod -Uri "http://localhost:5000/api/pdfconversion/validate?filePath=C:\Temp\Input\קובץ.docx"
```

### 💡 טיפ 2: שם אוטומטי
אם לא תציין `outputFileName`, השם יהיה:
```
mergePDF_20250122_143052.pdf
```

### 💡 טיפ 3: הורדה ישירה
אם אתה רוצה להוריד את הקובץ ישירות במקום לקבל מידע:
```powershell
Invoke-RestMethod `
    -Uri "http://localhost:5000/api/pdfconversion/merge-and-download" `
    -Method Post `
    -Body $body `
    -ContentType "application/json" `
    -OutFile "C:\Downloads\merged.pdf"
```

### 💡 טיפ 4: ערבוב סוגי קבצים
אפשר לערבב כל סוגי הקבצים הנתמכים:
```
"מסמך.docx,תמונה.jpg,טבלה.xlsx,מצגת.pptx,טקסט.txt"
```
הכל יהפוך ל-PDF אחד!

---

## מיקומי תיקיות

### תיקיית קלט (Input)
**מיקום:** `C:\Temp\Input`

כל הקבצים שאתה רוצה לאחד חייבים להיות כאן.

### תיקיית פלט (Output)
**מיקום:** `C:\Temp\Output`

הקובץ המאוחד נשמר כאן.

---

## שאלות נפוצות

**ש: כמה קבצים אפשר לאחד?**
ת: אין הגבלה! (מעבר למגבלות המערכת)

**ש: מה הגודל המקסימלי של קובץ?**
ת: כברירת מחדל 50MB לכל קובץ

**ש: אפשר לערבב עברית ואנגלית?**
ת: כן! שמות הקבצים יכולים להיות בעברית

**ש: מה קורה אם קובץ נכשל?**
ת: המערכת ממשיכה עם השאר ומדווחת על הכשלון

**ש: אפשר לשנות את סדר הקבצים?**
ת: כן, פשוט שנה את הסדר ברשימה

**ש: איך אני יודע שהתהליך הצליח?**
ת: התגובה כוללת `"success": true` ומספר הקבצים שעובדו

---

## תמיכה נוספת

- **מדריך API מלא:** `Tests/MERGE_API_GUIDE.md` (באנגלית)
- **סקריפט בדיקה:** `.\Tests\testMerge.ps1`
- **דוגמאות קוד:** ראה את המדריך הראשי `README.md`

---

**בהצלחה! 🚀**

_אם משהו לא עובד, נסה להריץ את הסקריפט המלא `testMerge.ps1` - הוא יעזור לך לאתר את הבעיה._
