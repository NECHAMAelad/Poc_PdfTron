# 🚀 מדריך שימוש מהיר - איחוד קבצים ל-PDF

## הסקריפט החדש: `quick-merge-test.ps1`

זהו סקריפט **אוטומטי מלא** שעושה הכל בשבילך!

---

## 🎯 איך להשתמש?

### דרך 1: מצב אינטראקטיבי (מומלץ!)

פשוט הרץ:

```powershell
.\Tests\quick-merge-test.ps1
```

הסקריפט יעשה **אוטומטית**:
1. ✅ יבדוק אם השרת רץ
2. ✅ אם לא - יפעיל אותו בחלון נפרד
3. ✅ יציג לך רשימת קבצים זמינים
4. ✅ ישאל אותך אילו קבצים לאחד
5. ✅ יבצע את האיחוד
6. ✅ יפתח את התוצאה

---

## 📍 **איפה להזין את שמות הקבצים?**

### אופציה 1: הזנת שמות קבצים
כשהסקריפט ישאל:
```
➤ קבצים:
```

**תכתוב את שמות הקבצים מופרדים בפסיק:**
```
document1.docx,image.jpg,report.xlsx
```

### אופציה 2: הזנת מספרים (קל יותר!)
הסקריפט מציג רשימה ממוספרת:
```
📂 קבצים זמינים בתיקיית הקלט:

   1. document1.docx
   2. image.jpg
   3. report.xlsx
   4. summary.txt
```

**פשוט תכתוב את המספרים:**
```
➤ קבצים: 1,2,3
```

או:
```
➤ קבצים: 1, 3, 4
```

---

## 📝 דוגמאות מלאות

### דוגמה 1: הרצה רגילה
```powershell
# הרץ את הסקריפט
PS> .\Tests\quick-merge-test.ps1

# הסקריפט מציג:
📂 קבצים זמינים בתיקיית הקלט:
   1. document1.docx
   2. image.jpg
   3. report.xlsx

📝 הזן את שמות הקבצים לאיחוד (מופרדים בפסיק):
➤ קבצים: 1,2,3

📝 שם לקובץ הפלט (אופציונלי, Enter לברירת מחדל):
➤ שם: דוח_מאוחד

# הסקריפט מאחד ופותח את הקובץ!
```

### דוגמה 2: עם פרמטרים (בלי שאלות)
```powershell
# מאחד קבצים ספציפיים
.\Tests\quick-merge-test.ps1 -Files "document1.docx,image.jpg,report.xlsx"

# מאחד עם שם מותאם אישית
.\Tests\quick-merge-test.ps1 -Files "file1.docx,file2.xlsx" -OutputName "דוח_רבעוני"
```

---

## 🎨 מה הסקריפט עושה?

### 1️⃣ בדיקת שרת
```
🔍 בודק אם השרת רץ...
✅ השרת כבר רץ!
🌐 כתובת: http://localhost:5063
```

או:
```
🔍 בודק אם השרת רץ...
⚠️  השרת לא רץ
🚀 מפעיל שרת...
⏳ ממתין לשרת להתחיל...
✅ השרת הופעל בהצלחה!
```

### 2️⃣ רשימת קבצים
```
📂 קבצים זמינים בתיקיית הקלט:
   מיקום: C:\Temp\Input

   1. document1.docx
   2. image.jpg
   3. report.xlsx
   4. summary.txt
```

### 3️⃣ בחירת קבצים
```
📝 הזן את שמות הקבצים לאיחוד (מופרדים בפסיק):

   דוגמאות:
   • file1.docx,file2.xlsx,file3.jpg
   • document.docx,image.png

   או הזן מספרים: 1,2,3

➤ קבצים: 1,2,3
```

### 4️⃣ שם קובץ הפלט
```
📝 שם לקובץ הפלט (אופציונלי, Enter לברירת מחדל):
➤ שם: דוח_מאוחד
```

אם לא תכניס שום דבר - השם יהיה:
```
mergePDF_20250122_143052.pdf
```

### 5️⃣ תוצאות
```
🔄 מאחד קבצים...

✅ איחוד הושלם בהצלחה!

📊 תוצאות:
   • קובץ פלט: דוח_מאוחד_20250122_143052.pdf
   • מיקום: C:\Temp\Output\דוח_מאוחד_20250122_143052.pdf
   • קבצים עובדו: 3/3
   • משך זמן: 00:00:05.1234567

✅ קבצים שאוחדו בהצלחה:
   ✓ document1.docx
   ✓ image.jpg
   ✓ report.xlsx

📂 פותח את הקובץ...
```

---

## 🔧 אופציות מתקדמות

### הרצה עם פרמטרים

```powershell
# מאחד קבצים ספציפיים
.\Tests\quick-merge-test.ps1 -Files "file1.docx,file2.jpg"

# עם שם פלט
.\Tests\quick-merge-test.ps1 -Files "file1.docx,file2.jpg" -OutputName "merged"

# בלי לפתוח אוטומטית
.\Tests\quick-merge-test.ps1 -Files "file1.docx,file2.jpg" -AutoOpen $false

# URL שונה
.\Tests\quick-merge-test.ps1 -BaseUrl "http://localhost:8080"

# תיקיות שונות
.\Tests\quick-merge-test.ps1 -InputFolder "D:\Files\Input" -OutputFolder "D:\Files\Output"
```

### פרמטרים זמינים:

| פרמטר | תיאור | ברירת מחדל |
|-------|-------|-----------|
| `-Files` | רשימת קבצים לאיחוד | (ריק - אינטראקטיבי) |
| `-OutputName` | שם קובץ הפלט | mergePDF_[תאריך] |
| `-AutoOpen` | לפתוח אוטומטית | `$true` |
| `-BaseUrl` | כתובת השרת | `http://localhost:5063` |
| `-InputFolder` | תיקיית קלט | `C:\Temp\Input` |
| `-OutputFolder` | תיקיית פלט | `C:\Temp\Output` |

---

## ⚠️ שגיאות נפוצות ופתרונות

### שגיאה 1: "לא נמצאו קבצים"
```
📂 קבצים זמינים בתיקיית הקלט:
   ⚠️  לא נמצאו קבצים!
```

**פתרון:**
1. העתק קבצים ל-`C:\Temp\Input`
2. או הרץ: `.\Tests\test-all-types.ps1 -CreateSamples "true"`

### שגיאה 2: "תיקיית הקלט לא קיימת"
```
⚠️  תיקיית הקלט לא קיימת: C:\Temp\Input
   יוצר תיקייה...
```

הסקריפט יוצר את התיקייה אוטומטית!

### שגיאה 3: "השרת לא עלה"
```
❌ השרת לא עלה אחרי 30 שניות
   בדוק את החלון שנפתח לשגיאות
```

**פתרון:**
1. בדוק את חלון השרת שנפתח
2. חפש שגיאות אדומות
3. אולי חסר `.NET 8 SDK`
4. נסה להריץ ידנית: `dotnet run`

### שגיאה 4: "קובץ לא תקין"
```
❌ קבצים שנכשלו:
   ✗ file1.docx
     שגיאה: File extension not allowed
```

**פתרון:**
- ודא שהקובץ הוא מסוג נתמך
- רשימה מלאה: Word, Excel, PowerPoint, תמונות, טקסט, PDF

---

## 💡 טיפים

### טיפ 1: השרת נשאר פועל
אחרי שהסקריפט מסיים, השרת **ממשיך לרוץ** בחלון הנפרד.
זה אומר שאפשר להריץ את הסקריפט שוב **בלי להמתין** להפעלת שרת!

```powershell
# הרצה ראשונה - מפעיל שרת (לוקח זמן)
.\Tests\quick-merge-test.ps1

# הרצה שנייה - השרת כבר רץ (מהיר!)
.\Tests\quick-merge-test.ps1
```

### טיפ 2: שימוש בשמות קבצים בעברית
אפשר להשתמש בשמות קבצים בעברית:
```
➤ קבצים: מסמך.docx,תמונה.jpg,דוח.xlsx
```

### טיפ 3: רווחים מותרים
אפשר להוסיף רווחים לנוחות:
```
➤ קבצים: file1.docx, file2.jpg, file3.xlsx
```
או:
```
➤ קבצים: 1, 2, 3
```

### טיפ 4: עצירת השרת
אם תרצה לעצור את השרת:
1. עבור לחלון השרת
2. לחץ `Ctrl + C`
3. או פשוט סגור את החלון

---

## 🆚 השוואה עם הסקריפט הישן

| תכונה | `testMerge.ps1` (ישן) | `quick-merge-test.ps1` (חדש) |
|-------|---------------------|------------------------------|
| מפעיל שרת אוטומטית | ❌ לא | ✅ כן |
| ממספר קבצים | ❌ לא | ✅ כן |
| ממשק ידידותי | ⚠️ בסיסי | ✅ מלא |
| בדיקת תיקיות | ⚠️ בסיסי | ✅ יוצר אם חסר |
| הצגת התקדמות | ❌ לא | ✅ כן |
| אמוג'י וצבעים | ⚠️ מעט | ✅ הרבה |

**המלצה:** השתמש ב-`quick-merge-test.ps1` - הוא עושה הכל!

---

## 📚 קבצים נוספים

| קובץ | תיאור | מתי להשתמש |
|------|-------|-----------|
| `quick-merge-test.ps1` | **⭐ מומלץ** - הכל אוטומטי | תמיד! |
| `testMerge.ps1` | הסקריפט הבסיסי | כשהשרת כבר רץ |
| `testPdfTron.ps1` | בדיקת קובץ בודד | המרה של קובץ אחד |
| `test-all-types.ps1` | בדיקת כל הסוגים | יצירת קבצי דוגמה |

---

## 🎬 תרחיש מלא לדוגמה

```powershell
# פתח PowerShell
# נווט לתיקיית הפרויקט
PS> cd "C:\Users\nechamao\Documents\POCPdf\Poc_PdfTron"

# הרץ את הסקריפט
PS> .\Tests\quick-merge-test.ps1

# ═══════════════════════════════════════════════
# PDF Merge - Quick Test & Server Launcher
# ═══════════════════════════════════════════════

# 🔍 בודק אם השרת רץ...
# ⚠️  השרת לא רץ
# 
# 🚀 מפעיל שרת...
# 📁 מיקום הפרויקט: C:\Users\nechamao\...\Poc_PdfTron
# ⏳ ממתין לשרת להתחיל...
# 
# ✅ השרת הופעל בהצלחה!
# 🌐 כתובת: http://localhost:5063

# 📂 קבצים זמינים בתיקיית הקלט:
#    מיקום: C:\Temp\Input
# 
#    1. document1.docx
#    2. image.jpg
#    3. report.xlsx
#    4. summary.txt

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 
# 📝 הזן את שמות הקבצים לאיחוד (מופרדים בפסיק):
# 
#    דוגמאות:
#    • file1.docx,file2.xlsx,file3.jpg
#    • document.docx,image.png
# 
#    או הזן מספרים: 1,2,3
# 
➤ קבצים: 1,2,3

# ✅ נבחרו קבצים: document1.docx,image.jpg,report.xlsx
# 
# 📝 שם לקובץ הפלט (אופציונלי, Enter לברירת מחדל):
➤ שם: דוח_רבעוני

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 
# 🔄 מאחד קבצים...
# 
# 📤 שולח בקשה:
# {
#   "sourceFiles": "document1.docx,image.jpg,report.xlsx",
#   "outputFileName": "דוח_רבעוני"
# }
# 
# ✅ איחוד הושלם בהצלחה!
# 
# 📊 תוצאות:
#    • קובץ פלט: דוח_רבעוני_20250122_143052.pdf
#    • מיקום: C:\Temp\Output\דוח_רבעוני_20250122_143052.pdf
#    • קבצים עובדו: 3/3
#    • משך זמן: 00:00:05.1234567
# 
# ✅ קבצים שאוחדו בהצלחה:
#    ✓ document1.docx
#    ✓ image.jpg
#    ✓ report.xlsx
# 
# 📂 פותח את הקובץ...
# [הקובץ נפתח ב-Adobe Reader]
# 
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 
# ✨ הבדיקה הושלמה!
# 
# ℹ️  השרת ממשיך לרוץ בחלון הנפרד
#    אפשר להשתמש בו שוב ללא הפעלה מחדש
# 
# 📂 קובץ הפלט נמצא ב:
#    C:\Temp\Output\דוח_רבעוני_20250122_143052.pdf
# 
# לחץ Enter לסיום...
```

---

**זהו! עכשיו פשוט תריץ:**

```powershell
.\Tests\quick-merge-test.ps1
```

**והכל יעבוד אוטומטית! 🚀**
